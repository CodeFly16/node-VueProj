{"version":3,"sources":["webpack:///./src/views/borrowManagement/borrowManagement.vue?d3aa","webpack:///src/views/borrowManagement/borrowManagement.vue","webpack:///./src/views/borrowManagement/borrowManagement.vue?01ad","webpack:///./src/views/borrowManagement/borrowManagement.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","showModal","_v","staticStyle","searchRd","spinning","dataSource","columns","scopedSlots","_u","key","fn","text","record","onDelete","_id","_e","$event","edit","reLendBook","returnBook","handleOk","model","value","callback","$$v","visible","expression","slot","isCanLend","labelCol","wrapperCol","isEdit","rdInfo","_s","status","lendCount","canLendCount","searchBook","bkInfo","$set","setDate","staticRenderFns","name","data","rdID","bkID","ldContinueTimes","ldDateOut","ldDateRetPlan","ldDateRetAct","ldOverDay","ldOverMoney","ldPunishMoney","lsHasReturn","show","canLendDay","computed","console","log","created","$moment","loadData","methods","date","dateString","add","format","component"],"mappings":"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","file":"js/chunk-2d2214b0.6eefa7d3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-card',[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.showModal}},[_vm._v(\" 借书 \")]),_c('a-input-search',{staticStyle:{\"width\":\"300px\",\"margin-left\":\"30px\"},attrs:{\"placeholder\":\"输入借书证号查询所有信息\"},on:{\"search\":_vm.searchRd}}),_c('a-spin',{attrs:{\"tip\":\"Loading...\",\"spinning\":_vm.spinning}},[_c('a-table',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"bordered\":\"\",\"data-source\":_vm.dataSource,\"columns\":_vm.columns},scopedSlots:_vm._u([{key:\"operation\",fn:function(text, record){return [(_vm.dataSource.length)?_c('a-popconfirm',{attrs:{\"title\":\"确认删除吗\"},on:{\"confirm\":function () { return _vm.onDelete(record._id); }}},[_c('a-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"type\":\"danger\"}},[_vm._v(\" 删除 \")])],1):_vm._e(),_c('a-button',{staticStyle:{\"margin-left\":\"10px\"},on:{\"click\":function($event){return _vm.edit(record._id)}}},[_vm._v(\"详情\")]),(_vm.dataSource.length)?_c('a-popconfirm',{attrs:{\"title\":\"确认续借吗\"},on:{\"confirm\":function () { return _vm.reLendBook(record); }}},[_c('a-button',{staticStyle:{\"margin-left\":\"10px\"}},[_vm._v(\"续借\")])],1):_vm._e(),(_vm.dataSource.length)?_c('a-popconfirm',{attrs:{\"title\":\"确认还书吗\"},on:{\"confirm\":function () { return _vm.returnBook(record); }}},[_c('a-button',{staticStyle:{\"margin-left\":\"10px\"}},[_vm._v(\"还书\")])],1):_vm._e()]}}])})],1),_c('a-modal',{attrs:{\"title\":\"借书\"},on:{\"ok\":_vm.handleOk},model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}},[_c('template',{slot:\"footer\"},[_c('a-button',{key:\"back\",on:{\"click\":function($event){_vm.visible = false && !_vm.isEdit}}},[_vm._v(\" 取消 \")]),_c('a-button',{key:\"submit\",attrs:{\"type\":\"primary\",\"disabled\":!_vm.isCanLend},on:{\"click\":_vm.handleOk}},[_vm._v(\" 确认 \")])],1),_c('a-form',{attrs:{\"label-col\":_vm.labelCol,\"wrapper-col\":_vm.wrapperCol}},[(!_vm.isEdit)?[_c('a-form-item',{attrs:{\"label\":\"借书证搜索\"}},[_c('a-input-search',{attrs:{\"placeholder\":\"输入借书证号\"},on:{\"search\":_vm.searchRd}})],1),(_vm.rdInfo.show)?_c('a-form-item',{attrs:{\"label\":\"读者相关信息\"}},[_c('div',[_vm._v(\" 读者状态:\"+_vm._s(_vm.rdInfo.status)+\" \")]),_c('div',[_vm._v(\" 已借书籍数量:\"+_vm._s(_vm.rdInfo.lendCount)+\" \")]),_c('div',[_vm._v(\" 可借书籍数量:\"+_vm._s(_vm.rdInfo.canLendCount)+\" \")])]):_vm._e(),_c('a-form-item',{attrs:{\"label\":\"待借图书搜索\"}},[_c('a-input-search',{attrs:{\"placeholder\":\"输入待借图书书号\"},on:{\"search\":_vm.searchBook}})],1),(_vm.bkInfo.show)?_c('a-form-item',{attrs:{\"label\":\"图书相关信息\"}},[_c('div',[_vm._v(\" 书籍状态:\"+_vm._s(_vm.bkInfo.status)+\" \")])]):_vm._e()]:_vm._e(),(_vm.isCanLend || _vm.isEdit)?[_c('a-form-item',{attrs:{\"label\":\"读者序号\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入读者序号\",\"disabled\":\"\"},model:{value:(_vm.model.rdID),callback:function ($$v) {_vm.$set(_vm.model, \"rdID\", $$v)},expression:\"model.rdID\"}})],1),_c('a-form-item',{attrs:{\"label\":\"图书序号\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入图书序号\",\"disabled\":\"\"},model:{value:(_vm.model.bkID),callback:function ($$v) {_vm.$set(_vm.model, \"bkID\", $$v)},expression:\"model.bkID\"}})],1),_c('a-form-item',{attrs:{\"label\":\"续借次数\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入续借次数\"},model:{value:(_vm.model.ldContinueTimes),callback:function ($$v) {_vm.$set(_vm.model, \"ldContinueTimes\", $$v)},expression:\"model.ldContinueTimes\"}})],1),_c('a-form-item',{attrs:{\"label\":\"借书日期\"}},[_c('a-date-picker',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"请选择借书日期\"},on:{\"change\":_vm.setDate},model:{value:(_vm.model.ldDateOut),callback:function ($$v) {_vm.$set(_vm.model, \"ldDateOut\", $$v)},expression:\"model.ldDateOut\"}})],1),_c('a-form-item',{attrs:{\"label\":\"应还日期\"}},[_c('a-date-picker',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"请选择应还日期\",\"disabled\":\"\"},model:{value:(_vm.model.ldDateRetPlan),callback:function ($$v) {_vm.$set(_vm.model, \"ldDateRetPlan\", $$v)},expression:\"model.ldDateRetPlan\"}})],1),_c('a-form-item',{attrs:{\"label\":\"实际还书日期\"}},[_c('a-date-picker',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"请选择实际还书日期\",\"disabled\":\"\"},model:{value:(_vm.model.ldDateRetAct),callback:function ($$v) {_vm.$set(_vm.model, \"ldDateRetAct\", $$v)},expression:\"model.ldDateRetAct\"}})],1),_c('a-form-item',{attrs:{\"label\":\"超期天数\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入超期天数\",\"disabled\":\"\"},model:{value:(_vm.model.ldOverDay),callback:function ($$v) {_vm.$set(_vm.model, \"ldOverDay\", $$v)},expression:\"model.ldOverDay\"}})],1),_c('a-form-item',{attrs:{\"label\":\"超期金额\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入超期金额（应罚款金额）\",\"disabled\":\"\"},model:{value:(_vm.model.ldOverMoney),callback:function ($$v) {_vm.$set(_vm.model, \"ldOverMoney\", $$v)},expression:\"model.ldOverMoney\"}})],1),_c('a-form-item',{attrs:{\"label\":\"罚款金额\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入罚款金额\",\"disabled\":\"\"},model:{value:(_vm.model.ldPunishMoney),callback:function ($$v) {_vm.$set(_vm.model, \"ldPunishMoney\", $$v)},expression:\"model.ldPunishMoney\"}})],1),_c('a-form-item',{attrs:{\"label\":\"是否已经还书\"}},[_c('a-switch',{attrs:{\"default-checked\":\"\"},model:{value:(_vm.model.lsHasReturn),callback:function ($$v) {_vm.$set(_vm.model, \"lsHasReturn\", $$v)},expression:\"model.lsHasReturn\"}})],1),_c('a-form-item',{attrs:{\"label\":\"借书操作员\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入借书操作员\"},model:{value:(_vm.model.OperatorLend),callback:function ($$v) {_vm.$set(_vm.model, \"OperatorLend\", $$v)},expression:\"model.OperatorLend\"}})],1),_c('a-form-item',{attrs:{\"label\":\"还书操作员\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入还书操作员\"},model:{value:(_vm.model.OperatorRet),callback:function ($$v) {_vm.$set(_vm.model, \"OperatorRet\", $$v)},expression:\"model.OperatorRet\"}})],1)]:_vm._e()],2)],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <a-card>\r\n    <a-button type=\"primary\" @click=\"showModal\">\r\n      借书\r\n    </a-button>\r\n\r\n    <a-input-search placeholder=\"输入借书证号查询所有信息\" style=\"width: 300px;margin-left: 30px\" @search=\"searchRd\"/>\r\n\r\n    <a-spin tip=\"Loading...\" :spinning=\"spinning\">\r\n      <a-table bordered :data-source=\"dataSource\" :columns=\"columns\" style=\"margin-top:10px\">\r\n        <template slot=\"operation\" slot-scope=\"text, record\">\r\n          <a-popconfirm\r\n              v-if=\"dataSource.length\"\r\n              title=\"确认删除吗\"\r\n              @confirm=\"() => onDelete(record._id)\">\r\n            <a-button type=\"danger\" style=\"margin-left: 10px\">\r\n              删除\r\n            </a-button>\r\n          </a-popconfirm>\r\n          <a-button style=\"margin-left: 10px\" @click=\"edit(record._id)\">详情</a-button>\r\n          <a-popconfirm\r\n              v-if=\"dataSource.length\"\r\n              title=\"确认续借吗\"\r\n              @confirm=\"() => reLendBook(record)\">\r\n            <a-button style=\"margin-left: 10px\">续借</a-button>\r\n          </a-popconfirm>\r\n          <a-popconfirm\r\n              v-if=\"dataSource.length\"\r\n              title=\"确认还书吗\"\r\n              @confirm=\"() => returnBook(record)\">\r\n            <a-button style=\"margin-left: 10px\">还书</a-button>\r\n          </a-popconfirm>\r\n        </template>\r\n      </a-table>\r\n    </a-spin>\r\n\r\n    <a-modal v-model=\"visible\" title=\"借书\" @ok=\"handleOk\">\r\n      <template slot=\"footer\">\r\n        <a-button key=\"back\" @click=\"visible = false && !isEdit\">\r\n          取消\r\n        </a-button>\r\n        <a-button key=\"submit\" type=\"primary\" @click=\"handleOk\" :disabled=\"!isCanLend\">\r\n          确认\r\n        </a-button>\r\n      </template>\r\n      <a-form :label-col=labelCol :wrapper-col=\"wrapperCol\">\r\n        <template v-if=\"!isEdit\">\r\n          <a-form-item label=\"借书证搜索\">\r\n            <a-input-search placeholder=\"输入借书证号\" @search=\"searchRd\"/>\r\n          </a-form-item>\r\n          <a-form-item label=\"读者相关信息\" v-if=\"rdInfo.show\">\r\n            <div>\r\n              读者状态:{{ rdInfo.status }}\r\n            </div>\r\n            <div>\r\n              已借书籍数量:{{ rdInfo.lendCount }}\r\n            </div>\r\n            <div>\r\n              可借书籍数量:{{ rdInfo.canLendCount }}\r\n            </div>\r\n          </a-form-item>\r\n          <a-form-item label=\"待借图书搜索\">\r\n            <a-input-search placeholder=\"输入待借图书书号\" @search=\"searchBook\"/>\r\n          </a-form-item>\r\n          <a-form-item label=\"图书相关信息\" v-if=\"bkInfo.show\">\r\n            <div>\r\n              书籍状态:{{ bkInfo.status }}\r\n            </div>\r\n          </a-form-item>\r\n        </template>\r\n\r\n        <template v-if=\"isCanLend || isEdit\">\r\n          <a-form-item label=\"读者序号\">\r\n            <a-input placeholder=\"请输入读者序号\"\r\n                     disabled\r\n                     v-model=\"model.rdID\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"图书序号\">\r\n            <a-input placeholder=\"请输入图书序号\"\r\n                     disabled\r\n                     v-model=\"model.bkID\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"续借次数\">\r\n            <a-input placeholder=\"请输入续借次数\"\r\n                     v-model=\"model.ldContinueTimes\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"借书日期\">\r\n            <a-date-picker placeholder=\"请选择借书日期\"\r\n                           style=\"width: 100%\"\r\n                           v-model=\"model.ldDateOut\"\r\n                           @change=\"setDate\">\r\n            </a-date-picker>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"应还日期\">\r\n            <a-date-picker placeholder=\"请选择应还日期\"\r\n                           style=\"width: 100%\"\r\n                           disabled\r\n                           v-model=\"model.ldDateRetPlan\">\r\n            </a-date-picker>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"实际还书日期\">\r\n            <a-date-picker placeholder=\"请选择实际还书日期\"\r\n                           style=\"width: 100%\"\r\n                           disabled\r\n                           v-model=\"model.ldDateRetAct\">\r\n            </a-date-picker>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"超期天数\">\r\n            <a-input placeholder=\"请输入超期天数\"\r\n                     disabled\r\n                     v-model=\"model.ldOverDay\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"超期金额\">\r\n            <a-input placeholder=\"请输入超期金额（应罚款金额）\"\r\n                     disabled\r\n                     v-model=\"model.ldOverMoney\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"罚款金额\">\r\n            <a-input placeholder=\"请输入罚款金额\"\r\n                     disabled\r\n                     v-model=\"model.ldPunishMoney\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"是否已经还书\">\r\n            <a-switch default-checked v-model=\"model.lsHasReturn\"/>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"借书操作员\">\r\n            <a-input placeholder=\"请输入借书操作员\"\r\n                     v-model=\"model.OperatorLend\">\r\n            </a-input>\r\n          </a-form-item>\r\n\r\n          <a-form-item label=\"还书操作员\">\r\n            <a-input placeholder=\"请输入还书操作员\"\r\n                     v-model=\"model.OperatorRet\">\r\n            </a-input>\r\n          </a-form-item>\r\n        </template>\r\n\r\n      </a-form>\r\n    </a-modal>\r\n  </a-card>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\n\r\n\r\nexport default {\r\n  name: \"borrowManagement\",\r\n  data() {\r\n    return {\r\n      model: {\r\n        rdID: '',\r\n        bkID: '',\r\n        ldContinueTimes: 0,\r\n        ldDateOut: '',\r\n        ldDateRetPlan: '',\r\n        ldDateRetAct: '',\r\n        ldOverDay: 0,\r\n        ldOverMoney: 0,\r\n        ldPunishMoney: 0,\r\n        lsHasReturn: false,\r\n      },\r\n      labelCol: {span: 7},\r\n      wrapperCol: {span: 14},\r\n      dataSource: [],\r\n      columns: [\r\n        {\r\n          title: '读者序号',\r\n          dataIndex: 'rdID',\r\n        },\r\n        {\r\n          title: '图书序号',\r\n          dataIndex: 'bkID',\r\n        },\r\n        {\r\n          title: '续借次数',\r\n          dataIndex: 'ldContinueTimes',\r\n        },\r\n        {\r\n          title: '借书日期',\r\n          dataIndex: 'ldDateOut',\r\n        },\r\n        {\r\n          title: '是否已经还书',\r\n          dataIndex: 'lsHasReturn',\r\n        },\r\n        {\r\n          title: '操作',\r\n          dataIndex: 'operation',\r\n          scopedSlots: {customRender: 'operation'},\r\n          width: '400px',\r\n        },\r\n      ],\r\n      rdInfo: {\r\n        show: false,\r\n        status: '',\r\n        lendCount: 0,\r\n        canLendCount: 0,\r\n        canLendDay: 0,\r\n      },\r\n      bkInfo: {\r\n        show: false,\r\n        status: ''\r\n      },\r\n      spinning: true,\r\n      visible: false,\r\n      isEdit: false,\r\n\r\n    }\r\n  },\r\n  computed: {\r\n    isCanLend() {\r\n      console.log(this.rdInfo.status === \"正常\" && this.rdInfo.lendCount < this.rdInfo.canLendCount && this.bkInfo.status === '在馆')\r\n      return this.rdInfo.status === \"正常\" && this.rdInfo.lendCount < this.rdInfo.canLendCount && this.bkInfo.status === '在馆'\r\n    }\r\n  },\r\n  created() {\r\n    console.log(this.$moment(\"add\", \"7 days\"))\r\n    this.loadData()\r\n  },\r\n  methods: {\r\n    //借书日期\r\n    setDate(date, dateString) {\r\n      console.log(date)\r\n      this.model.ldDateOut = dateString\r\n      this.model.ldDateRetPlan = this.$moment(dateString).add(this.rdInfo.canLendDay, 'days').format('YYYY-MM-DD ')\r\n      console.log(this.model.ldDateRetPlan)\r\n    },\r\n    //搜索学生\r\n    async searchRd(value) {\r\n      const data = await this.$http[0].get(`/search/readerInfo/${value}`)\r\n      if (data.status === 200) {\r\n        this.rdInfo.status = data.data.rdStatus\r\n        this.rdInfo.lendCount = data.data.rdLendCount\r\n        let canlendData = await this.$http[0].get(`search/readerType/${data.data.rdType}`)\r\n        this.rdInfo.canLendCount = canlendData.data.canLendQty\r\n        this.rdInfo.canLendDay = canlendData.data.canLendDay\r\n        this.model.rdID = value\r\n        this.rdInfo.show = true\r\n      }\r\n    },\r\n    //搜索图书\r\n    async searchBook(value) {\r\n      const data = await this.$http[0].get(`/search/book/${value}`)\r\n      if (data.status === 200) {\r\n        this.bkInfo.status = data.data.bkStatus\r\n        this.model.bkID = value\r\n        this.bkInfo.show = true\r\n      }\r\n    },\r\n\r\n    //还书\r\n    async returnBook(record) {\r\n      console.log(record)\r\n      if (record.lsHasReturn === '未还') {\r\n        record.lsHasReturn = true\r\n        record.ldDateRetAct = this.$moment().format('YYYY-MM-DD')\r\n        const data = await this.$http[0].post('/returnBook', record)\r\n        if (data.status === 200) {\r\n          this.loadData()\r\n          this.$message.success('还书成功')\r\n        }\r\n      } else {\r\n        this.$message.warning('此书已还')\r\n      }\r\n\r\n    },\r\n\r\n    //续借\r\n    async reLendBook(record) {\r\n      console.log(record)\r\n      //读者信息\r\n      const data = await this.$http[0].get(`/search/readerInfo/${record.rdID}`)\r\n      if (data.status === 200) {\r\n        //查看读者类型信息\r\n        let canlendData = await this.$http[0].get(`search/readerType/${data.data.rdType}`)\r\n        //可续借天数\r\n        let canlendDay = canlendData.data.canLendDay\r\n        //可续借次数\r\n        let relendNum = canlendData.data.relendNum\r\n\r\n        if (record.lsHasReturn === '未还') {\r\n          if (record.ldContinueTimes === relendNum) {\r\n            this.$message.warning(\"已超过最大续借次数\")\r\n          } else {\r\n            //续借\r\n            record.ldContinueTimes++\r\n            record.ldDateRetPlan = this.$moment(record.ldDateRetPlan).add(canlendDay, 'days').format('YYYY-MM-DD ')\r\n            record.lsHasReturn = false\r\n            console.log(record)\r\n            const data = await this.$http[0].post('/reLendBook', record)\r\n            if (data.status === 200) {\r\n              this.loadData()\r\n              this.$message.success('续借成功')\r\n            }\r\n          }\r\n        } else {\r\n          this.$message.warning(\"此书已还\")\r\n        }\r\n\r\n\r\n        console.log(canlendDay)\r\n        console.log(relendNum)\r\n      }\r\n    },\r\n\r\n    async onDelete(key) {\r\n      const data = await this.$http[0].delete(`/rest/borrowInfo/${key}`)\r\n      if (data.status === 200) {\r\n        this.loadData()\r\n        this.$message.success('删除成功')\r\n      }\r\n    },\r\n\r\n    async loadData() {\r\n      this.dataSource = []\r\n      let data = await this.$http[0].get('/rest/borrowInfo')\r\n      this.dataSource = [...data.data]\r\n      this.dataSource.forEach(item => {\r\n        console.log(item.lsHasReturn)\r\n        item.lsHasReturn ? item.lsHasReturn = '已还' : item.lsHasReturn = '未还'\r\n        item.ldDateOut = this.$moment(item.ldDateOut).format('YYYY-MM-DD')\r\n      })\r\n      this.spinning = false\r\n      console.log(this.dataSource)\r\n    },\r\n    showModal() {\r\n      this.isEdit = false\r\n      this.model = {\r\n        rdID: '',\r\n        bkID: '',\r\n        ldContinueTimes: 0,\r\n        ldDateOut: '',\r\n        ldDateRetPlan: '',\r\n        ldDateRetAct: '',\r\n        ldOverDay: 0,\r\n        ldOverMoney: 0,\r\n        ldPunishMoney: 0,\r\n        lsHasReturn: false,\r\n      }\r\n      this.visible = true\r\n    },\r\n    async handleOk(e) {\r\n      const data = await this.$http[0].post('/borrowBook', this.model)\r\n      if (data.status === 200) {\r\n        this.loadData()\r\n        this.$message.success('借书成功')\r\n      }\r\n      this.visible = false;\r\n    },\r\n    async edit(key) {\r\n      this.isEdit = true\r\n      const {data} = await this.$http[0].get(`/rest/borrowInfo/${key}`)\r\n      this.model = data\r\n      this.visible = true\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./borrowManagement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./borrowManagement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./borrowManagement.vue?vue&type=template&id=5747d75d&scoped=true&\"\nimport script from \"./borrowManagement.vue?vue&type=script&lang=js&\"\nexport * from \"./borrowManagement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5747d75d\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}